# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.137882237727, 0.137882237727,0.137863836818,0.137863836818,0.117967330457,0.0964657868964,0.0611056765278,0.055192854199,0.0497768902655,0.0564285481769,0.0584170648192,0.0585074661856,0.0585074661856,0.0586291561988,0.0586291561988,0.0585074661856,0.0630988502209,0.0667944547258,0.0668050410243,0.0691910650762,0.0687541446443,0.0785710197593,0.0823872035591,0.0865711297357,0.0865711297357,0.087035267483,0.087035267483,0.0855773001777,0.0835662703116,0.080819884408,0.085888403568,0.0948344870132,0.122041416199,0.137679925333,0.137863836818,0.137679925333,0.130183893405,0.132253010082,0.132825902961,0.128275537807,0.12255932496,0.122041416199,0.120108320346,0.12255932496,0.114072894695,0.114249054672,0.104102900928,0.106283517029,0.100859451694,0.0983932607998,0.0909018458285,0.0909018458285,0.0909018458285,0.0909018458285)
L_hpd_M95=c(0.327056989023, 0.327056989023,0.327056989023,0.327550534085,0.322354289171,0.315866863687,0.270189510738,0.230868320694,0.152712515457,0.141316934459,0.141316934459,0.14124527887,0.14124527887,0.141316934459,0.141316934459,0.14124527887,0.147704206575,0.149947312131,0.150867411439,0.154081800544,0.160418881211,0.179059692975,0.185585667705,0.19015309903,0.190038384807,0.19015309903,0.19015309903,0.19015309903,0.193455599976,0.262641885667,0.344262369751,0.378074936991,0.3995470402,0.411396261808,0.408866774037,0.408866774037,0.401174087878,0.403077755897,0.401174087878,0.398983105241,0.392756795982,0.393255210305,0.395328459629,0.401174087878,0.395328459629,0.406343920868,0.412213335451,0.417993735083,0.417993735083,0.433652513614,0.429634650839,0.431553365327,0.433652513614,0.433652513614)
M_hpd_m95=c(0.874277706262, 0.874277706262,0.0977230927107,0.0977230927107,0.0981326509035,0.0981326509035,0.0957961492193,0.0957961492193,0.094902554381,0.094902554381,0.094902554381,0.0948881688937,0.0948881688937,0.094902554381,0.094902554381,0.0948881688937,0.0942673456314,0.0948881688937,0.0943948601249,0.0902720580844,0.0777425236779,0.0528577139852,0.0466025480447,0.0429139446578,0.0404071489558,0.0337045849369,0.0282224823176,0.0330625799887,0.0323765939424,0.0323765939424,0.0337045849369,0.0329672225375,0.0348935207872,0.0344968241681,0.0329672225375,0.0309109197583,0.0318145322373,0.0315319085444,0.0309109197583,0.0278034329324,0.0242740252971,0.0269726343266,0.0221545427374,0.0242740252971,0.0208085797539,0.0163198274407,0.0221545427374,0.0221545427374,0.0221545427374,0.0221545427374,0.0221545427374,0.0221545427374,0.0221545427374,0.0221545427374)
M_hpd_M95=c(1.49293811589, 1.49293811589,0.1556416926,0.1556416926,0.154606021816,0.154356084057,0.151464497806,0.151464497806,0.151464497806,0.149502129822,0.149224904548,0.149299241028,0.149299241028,0.149224904548,0.149224904548,0.149502129822,0.149618946146,0.151250744641,0.151515796817,0.151515796817,0.166933759636,0.151464497806,0.141034275566,0.138024866921,0.134278268298,0.120534253372,0.104769447624,0.0985531728074,0.0948003194043,0.0933143551608,0.0943522450476,0.0945545024731,0.0981192400915,0.0982132097684,0.0985531728074,0.0985531728074,0.100596916926,0.100398395533,0.101469975007,0.101469975007,0.103440565157,0.111271396107,0.113971270805,0.12199839602,0.12199839602,0.125784185506,0.133011560138,0.133011560138,0.133011560138,0.133011560138,0.133011560138,0.133011560138,0.133011560138,0.133011560138)
R_hpd_m95=c(-1.25555536434, -1.25555536434,0.0106485150966,0.00981573584689,-0.00701738027747,-0.0317641591482,-0.0717269938126,-0.0759495340557,-0.0838856346587,-0.0761003502034,-0.0743492355802,-0.0721033218695,-0.0721033218695,-0.0719954401828,-0.0724891800452,-0.0709646231002,-0.0719954401828,-0.0648980418184,-0.0575133306501,-0.065007411978,-0.0758997422384,-0.0543698281249,-0.040371289378,-0.039027321564,-0.031836090634,-0.0146383828099,0.00458147465375,0.005992573596,0.005992573596,0.00361970853987,0.00818918471018,0.036799523289,0.0485644504676,0.0610261638138,0.0643285668078,0.0623799356961,0.0643285668078,0.0643285668078,0.0647235871899,0.0579687383714,0.0557861882006,0.0455036584805,0.0485000998853,0.0378877123519,0.0335786195687,0.0292659207455,0.0130179148684,0.00904811235001,0.00489449040406,-0.0026824539307,0.00489449040406,0.00489449040406,-0.000871744782139,-0.000871744782139)
R_hpd_M95=c(-0.608883134699, -0.608883134699,0.203820799726,0.203820799726,0.201034949151,0.198574287593,0.15064182837,0.116197648308,0.0425823211979,0.0220938705848,0.0220938705848,0.0245851553766,0.0240116116729,0.023793413293,0.0240116116729,0.0266631844207,0.026695217462,0.0351675091276,0.0433745088364,0.0431468238242,0.0691864912937,0.0772724952866,0.102276572979,0.113141227973,0.120435125309,0.133762703752,0.139497050134,0.134643582289,0.138589343112,0.209447189178,0.284202738306,0.331828910211,0.337696711615,0.343709333147,0.343709333147,0.343709333147,0.343709333147,0.343709333147,0.344524390741,0.343709333147,0.341421353745,0.336513370139,0.349276014511,0.343318348227,0.348401176704,0.367746663624,0.367746663624,0.367746663624,0.367746663624,0.381687018171,0.394157644734,0.395408890623,0.395680985782,0.395680985782)
L_mean=c(0.247506320927, 0.247506320927,0.247511712582,0.247351406716,0.242230872781,0.22789508604,0.140678314713,0.117684535776,0.105655624797,0.101605930447,0.101316399558,0.101241961047,0.101272905848,0.101311415465,0.101439771779,0.101809072942,0.103659930871,0.107221462697,0.1088599747,0.109800040476,0.113361010214,0.120626972019,0.124226387247,0.125506645761,0.125457976342,0.125390164788,0.125301516721,0.125598226076,0.126914879625,0.142128818814,0.192993770802,0.251655176955,0.269422001188,0.274761825735,0.276344417875,0.275650637465,0.274418658618,0.274098417572,0.273566762021,0.272865113649,0.270631745245,0.269842139387,0.26851898221,0.267701491792,0.267708530552,0.270388622548,0.271174168234,0.269977795827,0.268702725209,0.26661042528,0.266445847378,0.266574577381,0.267346310277,0.267405852)
M_mean=c(1.17248575807, 1.17248575807,0.124985928651,0.124986562094,0.1250092379,0.124804940095,0.124253120182,0.123748302791,0.124115718932,0.123260029896,0.123255802453,0.123161166345,0.123009244289,0.122869860429,0.12283321925,0.122634360431,0.122410859959,0.12219896857,0.12191083139,0.124016336384,0.130565532606,0.117398255894,0.0993469548298,0.0897072070581,0.0784563142762,0.0692090379007,0.0654225714275,0.0638298273793,0.0633759723091,0.0634216353106,0.063543315533,0.0638724953313,0.0642924433238,0.064441647872,0.0643149735959,0.0638299512771,0.0636508236993,0.0636173575333,0.0639870610556,0.0649949775117,0.0659427954311,0.0667745134599,0.0677477272197,0.0686609972741,0.0691806362377,0.0696657402984,0.0697559285726,0.0697559285726,0.0697559285726,0.0697559285726,0.0697559285726,0.0697559285726,0.0697559285726,0.0697559285726)
R_mean=c(-0.924979437141, -0.924979437141,0.12252578393,0.122364844622,0.117221634881,0.103090145945,0.0164251945315,-0.00606376701469,-0.0184600941351,-0.0216540994483,-0.0219394028949,-0.0219192052986,-0.0217363384416,-0.021558444964,-0.0213934474709,-0.0208252874891,-0.0187509290873,-0.0149775058733,-0.0130508566903,-0.014216295908,-0.0172045223919,0.00322871612449,0.0248794324167,0.0357994387029,0.0470016620657,0.0561811268876,0.0598789452939,0.0617683986964,0.0635389073156,0.078707183503,0.129450455269,0.187782681624,0.205129557864,0.210320177863,0.212029444279,0.211820686187,0.210767834919,0.210481060039,0.209579700965,0.207870136137,0.204688949814,0.203067625927,0.200771254991,0.199040494518,0.198527894314,0.200722882249,0.201418239662,0.200221867254,0.198946796636,0.196854496708,0.196689918805,0.196818648808,0.197590381704,0.197649923427)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.477017764975), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.64223192748), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.38111090077, 0.43524908436), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()