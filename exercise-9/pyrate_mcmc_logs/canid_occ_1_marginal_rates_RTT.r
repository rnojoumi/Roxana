# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.132642381846, 0.132642381846,0.132642381846,0.132642381846,0.1041823644,0.0720354691883,0.0625641835584,0.0517461527213,0.0517461527213,0.0606091700216,0.0613843881839,0.0613843881839,0.0613843881839,0.0613843881839,0.0613843881839,0.0613843881839,0.0613843881839,0.058789158163,0.0613843881839,0.0653467113263,0.0765618413026,0.0957899279472,0.0957899279472,0.0976895066446,0.0990199229985,0.0990199229985,0.0990199229985,0.0990199229985,0.0976895066446,0.0957899279472,0.103924407766,0.103924407766,0.122405626056,0.119556136156,0.119556136156,0.119556136156,0.109575930385,0.109575930385,0.109575930385,0.109575930385,0.109575930385,0.109575930385,0.125042495061,0.109575930385,0.119556136156,0.0568467651702,0.0568467651702,0.0568467651702,0.0568467651702,0.0568467651702)
L_hpd_M95=c(0.338055088916, 0.338055088916,0.338055088916,0.338055088916,0.331412710117,0.302000262202,0.277511088408,0.181377816169,0.154659349001,0.154659349001,0.154659349001,0.154659349001,0.154659349001,0.154659349001,0.154659349001,0.154425872452,0.154659349001,0.154659349001,0.16408983693,0.181526657486,0.210570792673,0.21494152074,0.212994292003,0.21494152074,0.21494152074,0.21494152074,0.21494152074,0.21494152074,0.216315582576,0.24059756953,0.347006179417,0.390669556698,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404323354633,0.404825092994,0.424293367303,0.404825092994,0.404323354633,0.404323354633,0.404323354633,0.404323354633)
M_hpd_m95=c(0.810838572477, 0.810838572477,0.0876241392507,0.0876241392507,0.0876241392507,0.0876241392507,0.0876241392507,0.0886098101699,0.0895347619635,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0918976745422,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635,0.0895347619635)
M_hpd_M95=c(1.45191810531, 1.45191810531,0.137038288041,0.137038288041,0.137038288041,0.137038288041,0.130023599338,0.127237870161,0.127237870161,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.128958302092,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161,0.127237870161)
R_hpd_m95=c(-1.16447342677, -1.16447342677,0.019056154367,0.019056154367,-0.00163407501203,-0.0465169826908,-0.0526958729634,-0.0764189900641,-0.0526958729634,-0.0520658247637,-0.0520658247637,-0.0520658247637,-0.0520658247637,-0.0520658247637,-0.0520658247637,-0.0465169826908,-0.0465169826908,-0.0465169826908,-0.0465169826908,-0.0465145475029,-0.027107675308,-0.0158279740945,-0.0140228982363,-0.0133730666931,-0.0133730666931,-0.0133730666931,-0.0133730666931,-0.0133730666931,-0.0200048610875,-0.0262704760621,-0.0073399169716,-0.00557284748961,0.00435725883164,0.00134190629411,0.00134190629411,0.0238059780508,0.00134190629411,0.00134190629411,0.00134190629411,0.00958892017247,0.00958892017247,0.00958892017247,0.00134190629411,0.00958892017247,0.00134190629411,-0.0376083237477,-0.046312886347,-0.046312886347,-0.046312886347,-0.046312886347)
R_hpd_M95=c(-0.578612238835, -0.578612238835,0.236887352621,0.236887352621,0.236887352621,0.195809329086,0.177992762182,0.056949619923,0.056949619923,0.0542781763256,0.0522736276706,0.0522736276706,0.0522736276706,0.0522736276706,0.0522736276706,0.0542781763256,0.0522736276706,0.0513796367768,0.0542781763256,0.0605739792187,0.110198852676,0.109683401624,0.109683401624,0.109683401624,0.109683401624,0.109683401624,0.109683401624,0.109683401624,0.109683401624,0.124349653914,0.236259342189,0.290573784306,0.290573784306,0.2974526754,0.2974526754,0.315736106321,0.2974526754,0.2974526754,0.2974526754,0.312497014861,0.312497014861,0.312497014861,0.290573784306,0.316120308742,0.316120308742,0.316120308742,0.2974526754,0.2974526754,0.2974526754,0.2974526754)
L_mean=c(0.248555549492, 0.248555549492,0.248555549492,0.24929698919,0.238001032824,0.191606832073,0.13900496267,0.108836272087,0.106212533733,0.104158490271,0.103797629636,0.103797629636,0.103797629636,0.103797629636,0.103927630207,0.105707965701,0.107611290262,0.108593927507,0.110614562753,0.115428250793,0.143468746189,0.151526216684,0.152145418621,0.154103572114,0.153853233683,0.15416236793,0.154319330772,0.154459341454,0.155377992993,0.158790663771,0.190010936798,0.244572020251,0.265438163766,0.272606035196,0.274540407277,0.275472735467,0.27541732493,0.275979928086,0.276698935542,0.277363815928,0.276577509952,0.275896892762,0.274182978105,0.274641205931,0.273294784364,0.267816696466,0.259749864222,0.259749864222,0.259786898399,0.259073936698)
M_mean=c(1.11855152047, 1.11855152047,0.112986782292,0.113073415515,0.113073415515,0.113036886831,0.110928502439,0.109586219318,0.10903817155,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.10874092473,0.108858645245,0.108858645245,0.108858645245,0.108565244558,0.108519332493,0.108519332493,0.108519332493,0.108519332493,0.108519332493,0.108519332493,0.108470177076,0.108470177076,0.108470177076,0.108470177076,0.108470177076,0.108627692991,0.108627692991,0.108627692991,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616,0.10926742616)
R_mean=c(-0.869995970976, -0.869995970976,0.1355687672,0.136223573674,0.124927617309,0.0785699452417,0.0280764602312,-0.000749947230547,-0.00282563781668,-0.00458243445883,-0.00494329509449,-0.00494329509449,-0.00494329509449,-0.00494329509449,-0.00481329452362,-0.00303295902881,-0.00112963446801,-0.000146997222804,0.00187363802315,0.00668732606245,0.0347278214588,0.0426675714392,0.0432867733756,0.0452449268686,0.0452879891253,0.0456430354366,0.0457999982789,0.045940008961,0.0468586605002,0.0502713312781,0.081491604305,0.136101843175,0.15696798669,0.16413585812,0.166070230201,0.167002558391,0.166789631939,0.167352235095,0.168071242551,0.168096389768,0.167310083792,0.166629466602,0.164915551945,0.165373779771,0.164027358204,0.158549270306,0.150482438062,0.150482438062,0.150519472239,0.149806510538)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.466722704034), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.59710991584), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.28092076945, 0.347732339616), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()